-- =============================================
-- מיגרציה: הוספת עמודת cbs_code לטבלת cities
-- להרצה ב-Supabase SQL Editor על DB קיים
-- =============================================

-- הוספת עמודת קוד למ"ס (CBS code) לטבלת ערים
ALTER TABLE public.cities ADD COLUMN IF NOT EXISTS cbs_code TEXT UNIQUE;

-- הזנת 39 ערים עם קודי למ"ס
-- פתח תקווה + Internet = active, כל השאר = inactive
INSERT INTO public.cities (name, cbs_code, is_active) VALUES
    ('פתח תקווה',           '7900', true),
    ('Internet',             NULL,   true),
    ('ירושלים',              '3000', false),
    ('תל אביב - יפו',       '5000', false),
    ('חיפה',                 '4000', false),
    ('באר שבע',              '9000', false),
    ('ראשון לציון',          '8300', false),
    ('בני ברק',              '6100', false),
    ('רמת גן',              '8600', false),
    ('כפר סבא',              '6900', false),
    ('נתניה',                '7400', false),
    ('אשדוד',                '70',   false),
    ('אשקלון',               '7100', false),
    ('חדרה',                 '6500', false),
    ('בית שמש',              '2610', false),
    ('חולון',                '6600', false),
    ('בת ים',                '6200', false),
    ('רעננה',                '8700', false),
    ('רחובות',               '8400', false),
    ('קריית גת',             '2630', false),
    ('קריית ביאליק',         '9500', false),
    ('קריית אונו',           '2620', false),
    ('קריית שמונה',          '2800', false),
    ('הוד השרון',            '9700', false),
    ('הרצליה',               '6400', false),
    ('לוד',                  '7000', false),
    ('עכו',                  '7600', false),
    ('עפולה',                '7700', false),
    ('טבריה',                '6700', false),
    ('נשר',                  '2500', false),
    ('מודיעין-מכבים-רעות',   '1200', false),
    ('רמלה',                 '8500', false),
    ('נהריה',                '9100', false),
    ('אילת',                 '2600', false),
    ('ראש העין',             '2640', false),
    ('אור יהודה',            '2400', false),
    ('מגדל העמק',            '874',  false),
    ('כנות (אזור תעשייה)',   '2006', false),
    ('ביתר עילית',           '3780', false)
ON CONFLICT (name) DO UPDATE SET cbs_code = EXCLUDED.cbs_code;
